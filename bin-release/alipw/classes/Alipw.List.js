Alipw.List=Alipw.extend(Alipw.BorderContainer,{baseCls:"alipw-list",selectedCls:"alipw-listitem-selected",scroll:true,store:null,selectable:true,multipleSelection:false,displayField:"text",valueField:"value",value:null,width:200,maxHeight:null,createFieldEl:true,applyTo:null,autoWidth:false,commitProperties:function(){Alipw.List.superclass.commitProperties.apply(this,arguments)},initialize:function(){Alipw.List.superclass.initialize.apply(this,arguments);this.listItems=new Array();this.selectedItems=new Array()},createDom:function(){Alipw.List.superclass.createDom.apply(this,arguments);this.renderListItem()},renderComplete:function(){Alipw.List.superclass.renderComplete.apply(this,arguments);if(this.scroll){this.getBody().css("overflow-y","auto")}},getContentWidth:function(){var b=0;var d;Alipw.each(this.listItems,function(e,f){d=f.getTextWidth();if(d>b){b=d}});var c=this.getWidthByBody(b);var a=this.getBody();if(a[0].scrollHeight>a.innerHeight()&&this.scroll){c+=Alipw.getScrollbarSize().width}return c},_doLayout:function(){if(this.autoWidth){this.width=this.getContentWidth()}Alipw.List.superclass._doLayout.apply(this,arguments);if(Alipw.isIE6||Alipw.isIE7){if(this.getBody()[0].style.height=="auto"){this.getBody().css("overflow-y","hidden")}else{if(this.scroll){this.getBody().css("overflow-y","auto")}}}},renderListItem:function(){if(!this.store instanceof Alipw.DataStore){return}var a=this.store.getData();Alipw.each(a,function(b,d){var c=new Alipw.ListItem({text:a[b][this.displayField],value:a[b][this.valueField],data:a[b],selectedCls:this.selectedCls,index:b,renderTo:this});if(this.value&&this.value==a[b][this.valueField]){if(this.multipleSelection||(!this.multipleSelection&&this.selectedItems.length==0)){c.select();this.selectedItems.push(c)}}c.addEventListener("itemclick",this.itemClickHandler_List,this);c.addEventListener("select",this.selectHandler_List,this);this.listItems.push(c)},this)},setValue:function(c){if(Alipw.isSet(c)&&this.listItems.length>0){var a=this.multipleSelection;var b=a?c.split(","):null;var d=false;Alipw.each(this.listItems,function(e,f){if(!a){if(f.value==c&&!d){d=true;f.select()}else{f.unselect();Alipw.removeItemFromArray(f,this.selectedItems)}}else{if(Alipw.indexOfArray(f.value,b)!=-1){f.select()}}},this);if(!a){if(!d){this.value=""}}else{}}},setStore:function(a){if(a instanceof Alipw.DataStore){this.store=a;this.updateListItems()}},updateListItems:function(){Alipw.each(this.listItems,function(a,b){b.destroy()});this.listItems.splice(0,999999999);this.selectedItems.splice(0,99999999);this.renderListItem()},applyValue_List:function(c,b){var a=this.value;this.value=c;if(a!=c){this.fireEvent("valueChange",{},false);if(b){this.fireEvent("change",{},false)}}},itemClickHandler_List:function(c){var b=c.currentTarget;var a=this.value;if(this.selectable){b.select(true)}this.fireEvent("itemclick",{index:b.index,item:b},false)},selectHandler_List:function(b){var a=b.currentTarget;if(!this.multipleSelection){if(Alipw.indexOfArray(a,this.selectedItems)!=-1){return}Alipw.each(this.selectedItems,function(c,d){d.unselect();Alipw.removeItemFromArray(d,this.selectedItems)},this)}else{if(Alipw.indexOfArray(a,this.selectedItems)!=-1){a.unselect();Alipw.removeItemFromArray(a,this.selectedItems);return}}this.selectedItems.push(a);if(!this.multipleSelection){this.applyValue_List(a.value,b.isUserOperation)}else{}this.fireEvent("select",{index:a.index,item:a},false)}});