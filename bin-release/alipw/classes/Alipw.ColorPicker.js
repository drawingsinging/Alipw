Alipw.ColorPicker=Alipw.extend(Alipw.BoxComponent,{applyTo:null,width:253,colors:[],baseCls:"alipw-colorpicker",autoRender:false,floating:true,showShadow:true,constructor:function(){Alipw.ColorPicker.superclass.constructor.apply(this,arguments)},commitProperties:function(){Alipw.ColorPicker.superclass.commitProperties.apply(this,arguments);if(this.colors.length==0){this.colors=this.getDefaultColors_ColorPicker()}if(this.applyTo){this._applyToEl=Alipw.convertEl(this.applyTo)}},initialize:function(){Alipw.ColorPicker.superclass.initialize.apply(this,arguments)},createDom:function(){Alipw.ColorPicker.superclass.createDom.apply(this,arguments);var g=new Alipw.Template(['<div class="{$baseCls}-statusbar">','<div class="{$baseCls}-color-preview"></div>','<div class="{$baseCls}-color-info"></div>',"</div>"]).set({baseCls:this.baseCls}).compile();this._colorPreivewBox=g.find("."+this.baseCls+"-color-preview");this._colorInfoBox=g.find("."+this.baseCls+"-color-info");this.el.append(g);var f=jQuery('<div class="'+this.baseCls+'-wrap"></div>');this.el.append(f);var d;for(var e=0,b=this.colors.length;e<b;e++){d=new Alipw.Template(['<div class="{$baseCls}-cell" _color="{$color}" style="background:{$color}">','<div class="{$baseCls}-cell-highlight-border"></div>',"</div>"]);d.set({baseCls:this.baseCls,color:this.colors[e]});var a=d.compile();a.bind("click",jQuery.proxy(this.cellClickHandler_ColorPicker,this));a.bind("mouseover",jQuery.proxy(this.cellMouseOverHandler_ColorPicker,this));a.bind("mouseout",jQuery.proxy(this.cellMouseOutHandler_ColorPicker,this));f.append(a)}if(this._applyToEl){this._applyToEl.bind("focus",jQuery.proxy(this.applyToElement_ColorPicker,this));jQuery(document).bind("click",jQuery.proxy(this.documentClickHandler_ColorPicker,this));this.addEventListener("select",function(h){this._applyToEl.val(h.color);this.hide()},this)}},renderComplete:function(){Alipw.ColorPicker.superclass.renderComplete.apply(this,arguments)},getDefaultColors_ColorPicker:function(){var e=new Array();var h,f,d;var i=0;var a=new Array(["#000000","#000000","#000000"],["#000000","#333333","#000000"],["#000000","#666666","#000000"],["#000000","#999999","#000000"],["#000000","#CCCCCC","#000000"],["#000000","#FFFFFF","#000000"],["#000000","#FF0000","#000000"],["#000000","#00FF00","#000000"],["#000000","#0000FF","#000000"],["#000000","#FFFF00","#000000"],["#000000","#00FFFF","#000000"],["#000000","#FF00FF","#000000"]);for(h=0;h<16;h=h+3){for(f=0;f<7;f=f+3){for(d=0;d<16;d=d+3){if((e.length-i*3)%18==0){e.push(a[i][0]);e.push(a[i][1]);e.push(a[i][2]);i++}c="#"+f.toString(16)+f.toString(16)+d.toString(16)+d.toString(16)+h.toString(16)+h.toString(16);e.push(c)}}}for(h=0;h<16;h=h+3){for(f=9;f<16;f=f+3){for(d=0;d<16;d=d+3){if((e.length-i*3)%18==0){e.push(a[i][0]);e.push(a[i][1]);e.push(a[i][2]);i++}c="#"+f.toString(16)+f.toString(16)+d.toString(16)+d.toString(16)+h.toString(16)+h.toString(16);e.push(c)}}}return e},cellClickHandler_ColorPicker:function(b){var a=jQuery(b.currentTarget);this.fireEvent("select",{color:a.attr("_color").toUpperCase()},false)},cellMouseOverHandler_ColorPicker:function(d){var a=jQuery(d.currentTarget);a.addClass(this.baseCls+"-cell-hover");var b=a.attr("_color").toUpperCase();this._colorPreivewBox.css("background-color",b);this._colorInfoBox.html(b)},cellMouseOutHandler_ColorPicker:function(d){var a=jQuery(d.currentTarget);a.removeClass(this.baseCls+"-cell-hover");var b="";this._colorPreivewBox.css("background-color",b);this._colorInfoBox.html(b)},applyToElement_ColorPicker:function(j){var d=jQuery(j.currentTarget);this.show();Alipw.ComponentManager.bringToFront(this);var b=jQuery(window).height();var g=d.offset();var a=this.el.outerHeight();var f=[d.innerWidth(),d.innerHeight()];var i=g.left;var h;if(b-(g.top-jQuery(document).scrollTop())>=a){h=g.top+f[1]}else{h=g.top-a}this.setPosition(i,h)},documentClickHandler_ColorPicker:function(a){if(Alipw.isInNode(a.target,this._applyToEl[0])||a.target==this._applyToEl[0]||Alipw.isInNode(a.target,this.el[0])||a.target==this.el[0]){return}this.hide()}});