Alipw.History=function(){var a=new Array();var b;var c=new Alipw.Nonvisual({autoInit:false});Alipw.apply(c,{blankURL:"",currentIndex:0,add:function(d){a.push(d);this.currentIndex=a.length-1;if(Alipw.getHash()!=d){this.status="adding"}window.location.hash=d},forward:function(){if(this.iframe){this.iframe.contentWindow.history.forward()}else{history.forward()}},back:function(){if(this.iframe){this.iframe.contentWindow.history.back()}else{history.back()}},init:function(){this.initialize();var e=this;Alipw.EventManager.enableHashChangeEvent();if(Alipw.isIE&&parseInt(Alipw.ieVersion)<8){b=document.createElement("iframe");b.settingSrc=true;b.style.position="absolute";b.style.width="1px";b.style.height="1px";b.style.visibility="hidden";b.style.left="-10000px";b.style.top="-10000px";var d=this.blankURL?this.blankURL:(Alipw.getPath()+"alipw/resources/assets/blank.html");b.src=d+"?"+Alipw.getHash();if(Alipw.isReady){document.body.appendChild(b)}else{Alipw.onReady(function(){document.body.appendChild(b)},this)}b.onreadystatechange=function(){if(b.readyState!="interactive"){return}if(b.settingSrc){b.settingSrc=false;return}var f=unescape(b.contentWindow.location.href.toString().split("?")[1]);b.changingHash=true;window.location.hash=f};this.iframe=b}Alipw.getWinProxy().addEventListener("hashChange",function(h){if(parseInt(Alipw.ieVersion)<8){if(b&&b.changingHash){b.changingHash=false}else{if(Alipw.isIE6&&e.status!="adding"){window.location.reload()}b.settingSrc=true;var g=e.blankURL?e.blankURL:(Alipw.getPath()+"alipw/resources/assets/blank.html");b.src=g+"?"+Alipw.getHash()}}if(e.status=="adding"){e.status="added";return}var f=new Object();f.token=h.hash;f.lastToken=h.lastHash;e.fireEvent("change",f)})},getToken:function(){return Alipw.getHash()}});return c}();